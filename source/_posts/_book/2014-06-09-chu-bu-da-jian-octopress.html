<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>初步搭建Octopress | My Book</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.5.0">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
        
    
    
    <link rel="next" href="./2014-08-28-xcode-headerdoc-jiao-cheng.html" />
    
    
    <link rel="prev" href="./index.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="gitbook/style.css">


        
    <div class="book" data-level="1.1" data-basepath="." data-revision="1421481540811">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         章节二
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter active" data-level="1.1" data-path="2014-06-09-chu-bu-da-jian-octopress.html">
            
                
                    <a href="./2014-06-09-chu-bu-da-jian-octopress.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         初步搭建Octopress
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="2014-08-28-xcode-headerdoc-jiao-cheng.html">
            
                
                    <a href="./2014-08-28-xcode-headerdoc-jiao-cheng.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         Xcode HeaderDoc 教程
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="chapter/README.html">
            
                
                    <a href="./chapter/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         XMPP通讯
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="2.1" data-path="2015-01-06-xmppjian-dan-yan-jiu-zhuan.html">
            
                
                    <a href="./2015-01-06-xmppjian-dan-yan-jiu-zhuan.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         XMPP简单研究[转]
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >My Book</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_30">
                    
                        <p>layout: post
title: &quot;初步搭建Octopress&quot;
date: 2014-06-09 23:26:22 +0800
comments: true
publiced: true
tags: [octopress,blog,github,mou,ruby]
keywords: boys,octopress,技术</p>
<h2 id="categories-octopress">categories: Octopress</h2>
<h4 id="">软件支持：</h4>
<ol>
<li><strong>Github</strong>:后台新建项目，点击<a href="https://help.github.com/articles/set­up­git" target="_blank">下载</a></li>
<li><strong>iTerm2</strong>:可以替代mac终端，相当强大。<a href="http://www.iterm2.com/#/section/home" target="_blank">下载</a></li>
<li><strong>ruby</strong>:ruby安装包  <a href="http://ruby.taobao.org/mirrors/ruby/" target="_blank">下载</a></li>
<li><strong>Mou</strong>:MarkDown编辑软件，可用于后期发布博客文章。<a href="http://mouapp.com/" target="_blank">下载</a></li>
<li><strong>Xcode</strong>：它将帮助你安装好Unix环境需要的开发包。</li>
</ol>
<p>￼<!--显示文章缩略部分的标记方法-->
<!-- more --></p>
<h4 id="">学习目的：</h4>
<p>要求:搭建一个独立博客网站,首先要有台连接到英特网服务器,要有前端的页面和后端的数据库,以及域名等.</p>
<ol>
<li><p>github可以提供给我们的是,github一个免费的代码托管仓库,它支持用户html页面的显示,用户可以上传HTML文件,然后在远程像访问网页一样访问它。</p>
</li>
<li><p>这时，博客还缺具有管理能力的网站后台,github不提供数据库等，对于博客这种数据规模很小,便可返璞归真,用回静态页面。</p>
</li>
<li><strong>Octopress</strong>:能将易于编写的<strong>Markdown</strong>的文本，翻译成为繁琐的<strong>html</strong>页面，同时帮助用户管理<strong>html</strong>页面并发布到github page上。</li>
</ol>
<h4 id="">搭建环境：</h4>
<ol>
<li><p><strong>Github</strong>:既然要托管到github,那么便要有github的环境. 检查本机的git环境,在命令行输入 <code>git--version</code></p>
</li>
<li><p><strong>Octopress</strong>:是基于Jekyll的,需要ruby的环境编译。检查本机ruby环境，命令行：<code>ruby-v</code>ruby的version1.9.3以上,新版的Mac,这些都是有装的。</p>
</li>
<li><strong>gcc</strong>和<strong>make</strong>,ruby的环境需要gcc,这个会通过安装xcode的command line tool来完成安装 检查本机gcc环境，命令行：<code>gcc -v</code></li>
</ol>
<h4 id="octpress">安装Octpress:</h4>
<p>通过Git安装:</p>
<ul>
<li>下载<strong>Octopress</strong>：<code>gitclonegit://github.com/imathis/octopress.git octopress</code></li>
<li>进入<strong>Octopress</strong>目录：<code>cd octopress</code></li>
<li>安装必要的依赖包：<ul>
<li><code>gem install bundler</code></li>
<li><code>rbenv rehash</code> # If you use rbenv, rehash to be able to run the bundle command</li>
<li><code>bundle install</code></li>
</ul>
</li>
<li>最后安装Octopress:<code>rake install</code></li>
</ul>
<h4 id="">配置：</h4>
<ul>
<li>修改配置文件<strong>_config.yml</strong>：<ul>
<li>配置个人站点的信息：<strong>url</strong>:git远程库地址，<strong>title</strong>:博客题目,<strong>author</strong>:作者名,等。<ul>
<li>注意：最好将twitter相关的配置信息全部删掉,否则由于GFW的原因,将会造成页面load很慢。</li>
</ul>
</li>
</ul>
</li>
<li>修改定制文件：/source/_includes/custom/head.html把google的自定义字体去掉,原因同上。</li>
</ul>
<h4 id="">写博客：</h4>
<p>博文是用markdown语法，另外扩充一些插件，网上相关介绍很多，例如：<a href="http://daringfireball.net/projects/markdown/" target="_blank">这个</a></p>
<ul>
<li><p>新建Markdown文件:          <code>rake new_post[&#39;文章名&#39;]</code>或 <code>rake new_page[&#39;404&#39;]</code></p>
</li>
<li><p>翻译Mardown为静态文件:   <code>rake generate</code></p>
</li>
<li><p>检测文件变化：            <code>rake watch</code></p>
</li>
<li><p>启动本机测试端口4000：  <code>rake preview</code></p>
</li>
<li><p>发布至git库：            <code>rake deploy</code></p>
</li>
</ul>
<h4 id="">添加多说：</h4>
<p>  需要在多说网注册个帐号，添加站点，获取站点 <font color=red>short_name</font>.</p>
<ul>
<li><h6 id="">底部评论：</h6>
<ul>
<li>在 <font color=red> _config.yml</font>     中添加
{%codeblock lang:ruby %}<h1 id="duoshuo-comments">duoshuo comments</h1>
duoshuo_comments: true
duoshuo_short_name: yourname
{%endcodeblock%}</li>
</ul>
</li>
<li>在<font color=red><code>source/_layouts/post.html</code></font>中的<font color=red> disqus</font>代码：</li>
</ul>
<p>{%codeblock lang:js %}
{ % if site.disqus_short_name and page.comments == true % }
    <section>
        <h1>Comments</h1>
         <div id="disqus_thread" aria-live="polite">{ % include post/disqus_thread.html % }</div>
    </section>
{ % endif % }
{%endcodeblock%}
下方添加 <font color=red>多说评论</font> 模块:</p>
<p>{%codeblock lang:js %}
{ % if site.duoshuo_short_name and site.duoshuo_comments == true and  page.comments == true % }</p>
<p><section>
             <h1>Comments</h1>
                 <div id="comments" aria-live="polite">{ % include post/duoshuo.html % }</div>
                 </section>
{ % endif % }
{%endcodeblock%}</p>
<ul>
<li>然后就按路径创建一个<font color=red>source/_includes/post/duoshuo.html</font></li>
</ul>
<p>{%codeblock lang:js %}
    <!-- Duoshuo Comment BEGIN -->
    <div class="ds-thread" data-title="{% if site.titlecase %}{{ post.title | site.titlecase }}{% else %}{{ post.title }}{% endif %}"></div>
    <script type="text/javascript">
      var duoshuoQuery = {short_name:&quot;{{ site.duoshuo_short_name }}&quot;};
      (function() {
        var ds = document.createElement(&#39;script&#39;);
        ds.type = &#39;text/javascript&#39;;
        ds.async = true;
        ds.src = &#39;<a href="http://static.duoshuo.com/embed.js" target="_blank">http://static.duoshuo.com/embed.js</a>&#39;;
        ds.charset = &#39;UTF-8&#39;;
        (document.getElementsByTagName(&#39;head&#39;)[0]  || document.getElementsByTagName(&#39;body&#39;)[0]).appendChild(ds);
        })();
    </script>
    <!-- Duoshuo Comment END -->
{%endcodeblock%}</p>
<p>随后，再修改 <font color=red>_includes/article.html </font>文件,</p>
<pre><code class="lang-js">{ % <span class="hljs-keyword">if</span> site.disqus_short_name and page.comments != <span class="hljs-literal">false</span> and post.comments !=<span class="hljs-literal">false</span> and site.disqus_show_comment_count == <span class="hljs-literal">true</span> % }
             | <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"{ % if index % }{{ root_url }}{{ post.url }}{ % endif % }#disqus_thread"</span>&gt;</span>Comments<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
{ % endif % }</span>
</code></pre>
<p>下方添加如下<font color=red>多说评论链接路径</font>：</p>
<p>{%codeblock lang:js %}
{ % if site.duoshuo_short_name and page.comments != false and post.comments != false and site.duoshuo_comments == true % }
| <a href="{ % if index % }{{ root_url }}{{ post.url }}{ % endif % }#comments">Comments</a>
{ % endif % }</p>
<p>{%endcodeblock %}</p>
<ul>
<li><h6 id="">首页侧边栏插入最新评论</h6>
<ul>
<li><p>首先在 _config.yml 中再插入如下代码
{%codeblock lang:ruby %}
duoshuo_asides_num: 10      # 侧边栏评论显示条目数
duoshuo_asides_avatars: 0   # 侧边栏评论是否显示头像
duoshuo_asides_time: 0      # 侧边栏评论是否显示时间
duoshuo_asides_title: 0     # 侧边栏评论是否显示标题
duoshuo_asides_admin: 0     # 侧边栏评论是否显示作者评论
duoshuo_asides_length: 18   # 侧边栏评论截取的长度
{%endcodeblock %}</p>
</li>
<li><p>再创建 <font color=red>_includes/custom/asides/recent_comments.html</font>
{%codeblock lang:html %}
<section>
<h1>Recent Comments</h1>
&lt;ul class=&quot;ds-recent-comments&quot;
data-num-items=&quot;{{ site.duoshuo_asides_num }}&quot;
 data-show-avatars=&quot;{{ site.duoshuo_asides_avatars }}&quot;
  data-show-time=&quot;{{ site.duoshuo_asides_time }}&quot;
   data-show-title=&quot;{{ site.duoshuo_asides_title }}&quot;</p>
<pre><code>data-show-admin=&quot;{{ site.duoshuo_asides_admin }}&quot;
data-excerpt-length=&quot;{{ site.duoshuo_asides_length }}&quot;&gt;&lt;/ul&gt;
</code></pre><p>{ % if index % }</p>
<!-- 多说js加载开始，一个页面只需要加载一次 -->
<pre><code>&lt;script type=&quot;text/javascript&quot;&gt;
  var duoshuoQuery = {short_name:&quot;{{ site.duoshuo_short_name }}&quot;};
  (function() {
    var ds = document.createElement(&#39;script&#39;);
    ds.type = &#39;text/javascript&#39;;
    ds.async = true;
    ds.src = &#39;http://static.duoshuo.com/embed.js&#39;;
    ds.charset = &#39;UTF-8&#39;;
    (document.getElementsByTagName(&#39;head&#39;)[0]  ||
    document.getElementsByTagName(&#39;body&#39;)[0]).appendChild(ds);
    })();
&lt;/script&gt;
</code></pre><!-- 多说js加载结束，一个页面只需要加载一次 -->
<p>{ % endif % }
</section>
{%endcodeblock %}</p>
</li>
</ul>
</li>
<li><p>最后修改：<font color=red>_config.yml </font>配置:</p>
<ul>
<li>方式一：在<font color=red> blog_index_asides</font> 行或 <font color=red>page_asides </font>行或 <font color=red>post_asides </font>添加：</li>
</ul>
</li>
</ul>
<p>{%codeblock lang:ruby %}
blog_index_asides:[custom/asides/recent_comments.html]
或
page_asides:[custom/asides/recent_comments.html]
或
post_asides:[custom/asides/recent_comments.html]
{%endcodeblock %}</p>
<ul>
<li><p>方式二：将路径添加到 default_asides:[...] 中
{%codeblock lang:ruby %}
default_asides: [custom/asides/recent_comments.html, asides/recent_posts.html, ...]
{%endcodeblock %}</p>
</li>
<li><p>Update</p>
<pre><code class="lang-html">多说评论似乎升级了系统，无法自动获取到页面文章标题，所以手动在评论页插入 data-title。--2013.09.10
</code></pre>
<h4 id="tips">Tips:</h4>
</li>
</ul>
<ul>
<li><h6 id="">发布图文：</h6>
</li>
</ul>
<p>如果在文章中上传图片：</p>
<pre><code>* 直接copy到/source/images目录即可。便可以以相对路径(/images/imgname.png)的形式，在文章中引用。

* 或找一个图库站点，例如flickr之类，然后在文章中引用该图片远程路径即可。
</code></pre><ul>
<li><h6 id="">域名：</h6>
如果有自己的域名空间，可以将域名指向自己的博客，步骤如下：</li>
</ul>
<pre><code>* **配置DNS(需购买域名)**:在域名管理中，新建一个CNAME指向，将自己的域名指向yourname.github.com.

* **给repo配置域名**:在source目录里，新建一个名为CNAME的文件，然后将自己的域名输入即可。

* 将内容push到github后，大概需审核一个小时左右生效，然后就可以使用自己的域名访问该博客了。
</code></pre><ul>
<li><h6 id="google-analytics">添加百度统计和google analytics</h6>
<ul>
<li>从<a href="http://tongji.baidu.com/" target="_blank">百度统计</a>获取脚本,然后添加到文件source/_includes/after_footer.html文件中。</li>
<li>从<a href="https://support.google.com/analytics/" target="_blank">google analytics</a>获取跟踪ID,然后将这个ID添加到_config.yml文件的google_analytics_tracking_id后面即可。<!--![alt text](https://github.com/adam-p/markdown-here/raw/master/src/common/images/icon48.png "title text")-->
</li>
</ul>
</li>
<li><p><strong>Octopress</strong>目录结构，及之间的关系：</p>
</li>
</ul>
<p>￼<img src="/images/sourceFrame.png" alt="alt text" title="Octopress目录图解"></p>
<ul>
<li><h6 id="">原理：</h6>
<ul>
<li><p>Octopress版本库：</p>
<ul>
<li><p><strong>gh-pages</strong>分支：用于存放生成的最终网页。</p>
</li>
<li><p><strong>source</strong>分支:用于存放最初的markdown文件。</p>
</li>
</ul>
<p>职责详述：平时写作和提交都在<strong>source</strong>分支下，当需要发布时，<code>rake deploy</code> 命令会将内容生成到public这个目录，然后将这个目录中的内容push到<strong>gh-pages</strong>分支中。</p>
</li>
</ul>
</li>
<li><ul>
<li>其中<strong>sass</strong>和<strong>source</strong>:这是博客的源代码文件目录。发布时，需要把源代码也上传到github上,这样便可以多台机写博客了。</li>
</ul>
</li>
<li><ul>
<li><strong>_deploy</strong>:是通过octopress生成的静态页面的博客文件夹,我们可以看到它的里面也有.git的文件。<ul>
<li>cd进到该目录,使用<code>git remote ­v</code>查看
{%codeblock lang:js %}
origin <a href="http://github.com/....github.io(fetch" target="_blank">http://github.com/....github.io(fetch</a>)
origin <a href="http://github.com/....github.io(push" target="_blank">http://github.com/....github.io(push</a>)
{%endcodeblock%}</li>
</ul>
</li>
</ul>
</li>
<li>它会在我们使用<code>rake deploy</code>时自动push到该远程库的<strong>gh-pages</strong>分支。这时就不需要再手动push。只需要将博客源代码手动push到该远程库的<strong>source</strong>分支中.
  <strong>以上细节可参照Octopress根目录中Rakefile配置信息</strong></li>
<li><ul>
<li>使用多台电脑的同时写博客<ul>
<li><ol>
<li>需要先拿把<strong>source</strong> code拿下来 <code>git pull origin source</code></li>
</ol>
</li>
<li><ol>
<li><code>check in</code>更新,将本地 <strong>source</strong>分支上的代码，合并到远程仓库上<pre><code>git add .
git commit -m &#39;yourmessage&#39;
git push origin source
</code></pre><h6 id="">版本管理</h6>
</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>你可以先去github上新建一个空的Repo（最好是private的，否则可能会被其他人拿到你的source），拿到repo的url，然后到octopress目录下执行下面这些操作：</p>
<pre><code class="lang-ruby"><span class="hljs-comment"># 因为你是从octopress github上clone的，所以需要把origin这个branch换一个名字</span>
git remote rename origin octopress
git remote add origin (your github url)
<span class="hljs-comment"># 把你的github branch作为默认的branch</span>
git config branch.master.remote origin
<span class="hljs-comment"># 把你的octopress导入到github上去</span>
git push -u origin master
</code></pre>
<p>如果你新增加了博客或者修改了某些内容，你可以把你的改动commit到github上去：</p>
<pre><code>git add source
git commit -a -m &#39;new blog or edit some blog&#39;
git push -u origin master
</code></pre><p>如果octopress有更新，你可以直接pull octopress这个branch进行更新即可</p>
<pre><code>git pull octopress master
git push -u origin master
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./index.html" class="navigation navigation-prev " aria-label="Previous page: 章节二"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./2014-08-28-xcode-headerdoc-jiao-cheng.html" class="navigation navigation-next " aria-label="Next page: Xcode HeaderDoc 教程"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
